
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Polynomial interpolation &#8212; Computational Methods MATH0058 lecture notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4.1_interpolation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to quadrature" href="4.2_quadrature.html" />
    <link rel="prev" title="Least-squares with constraints" href="3.4_constrained_least_squares_problems.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Computational Methods MATH0058 lecture notes - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Computational Methods MATH0058 lecture notes - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Abstract error analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0.1_matrix_vector_norms.html">Measuring distances</a></li>
<li class="toctree-l1"><a class="reference internal" href="0.2_error_analysis.html">Backward error analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="0.3_linear_system_error.html">The condition number of linear systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Implementation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.1_floating_point_arithmetic.html">Floating point numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.2_numpy_and_data_layouts.html">Memory layout and NumPy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LU decomposition</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="2.1_lu_decomposition.html">LU decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.2_complexity_notation.html">Asymptotic notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.3_lu_backward_error.html">Backward error and pivoting</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.4_python_lu_decomposition.html">Python implementation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Orthogonal decompositions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="3.1_qr_decomposition.html">QR decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.2_singular_value_decomposition.html">Singular value decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.3_least_squares_problems.html">Least-squares problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.4_constrained_least_squares_problems.html">Least-squares with constraints</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interpolation and quadrature</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Polynomial interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.2_quadrature.html">Introduction to quadrature</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.3_stable_quadrature_schemes.html">Stable quadrature schemes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Eigenvalue problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5.1_eigenvalues_basic_properties.html">Basic properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.2_computing_eigenvalues.html">Computing eigenvalues</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.3_computing_eigenspaces.html">Computing the eigensystem</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bm1_notation_and_facts.html">Notation and facts</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm2_programming_resources.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm3_markdown.html">Markdown and LaTeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm4_bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm5_typos.html">Report typos</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4.1_interpolation.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Polynomial interpolation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-skills">Python skills</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-check-questions">Self-check questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-material">Optional material</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="polynomial-interpolation">
<h1>Polynomial interpolation<a class="headerlink" href="#polynomial-interpolation" title="Link to this heading">#</a></h1>
<p>The set of real polynomials of degree less than or equal to <span class="math notranslate nohighlight">\(n\)</span> is denoted by <span class="math notranslate nohighlight">\(\mathcal{P}_n\)</span>. We consider the following task:</p>
<div class="tip admonition">
<p class="admonition-title">Polynomial Interpolation</p>
<p>Given <span class="math notranslate nohighlight">\(n+1\)</span> distinct points <span class="math notranslate nohighlight">\(x_0,x_1,\dots,x_n\)</span>, and <span class="math notranslate nohighlight">\(n+1\)</span> values <span class="math notranslate nohighlight">\(y_0,y_1,\dots,y_n\)</span>, find a polynomial <span class="math notranslate nohighlight">\(p_n \in \mathcal{P}_n\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
p(x_j)=y_j \qquad \forall j \in \{ 0, \ldots, n \}.
\]</div>
</div>
<p>In this section, we will answer the following questions:</p>
<ol class="arabic simple">
<li><p>Does a polynomial <span class="math notranslate nohighlight">\(p_n\)</span> with <span class="math notranslate nohighlight">\(p_n(x_j)=y_j\)</span> always exist, and if yes, is it unique?</p></li>
<li><p>How can we construct such a polynomial in practice?</p></li>
<li><p>If the values <span class="math notranslate nohighlight">\(y_j\)</span> are samples of a function, do we observe convergence to the function as <span class="math notranslate nohighlight">\(n\rightarrow\infty\)</span>?</p></li>
</ol>
<p>To begin with, we consider the special case</p>
<div class="math notranslate nohighlight">
\[
y_j = \delta_{ij},
\]</div>
<p>meaning that <span class="math notranslate nohighlight">\(y_i = 1\)</span> and <span class="math notranslate nohighlight">\(y_j = 0\)</span> for <span class="math notranslate nohighlight">\(i \neq j\)</span>. It has the solution</p>
<div class="math notranslate nohighlight">
\[  
L_j(x)= \prod_{i=0,i \neq j}^n \frac{(x-x_i)}{(x_j-x_i)}.  
\]</div>
<p>because <span class="math notranslate nohighlight">\(\text{deg}(L_j)=n\)</span> and <span class="math notranslate nohighlight">\(L_j\)</span> interpolates <span class="math notranslate nohighlight">\(y_j = \delta_{ij}\)</span> at <span class="math notranslate nohighlight">\(x_j\)</span>. The functions <span class="math notranslate nohighlight">\(L_k\)</span> are called <em>Lagrange basis polynomials</em>.</p>
<p>The solution to the original interpolation problem is now constructed as</p>
<div class="math notranslate nohighlight">
\[  
p_n(x)= \sum_{j=0}^n y_j L_j(x).  
\]</div>
<p>We refer to <span class="math notranslate nohighlight">\(p\)</span>, when written in this form, as the <em>Lagrange interpolation polynomial</em>. We still need to prove uniqueness.</p>
<div class="proof theorem admonition" id="theorem-0">
<p class="admonition-title"><span class="caption-number">Theorem 9 </span> (Existence and uniqueness of interpolating polynomial)</p>
<section class="theorem-content" id="proof-content">
<p>Given <span class="math notranslate nohighlight">\(\{ (x_i,y_i) \}_{i=0}^n\)</span> with <span class="math notranslate nohighlight">\(x_i &lt; x_{i+1}\)</span>, there exists a unique <span class="math notranslate nohighlight">\(p_n \in \mathcal{P}_n\)</span> such that <span class="math notranslate nohighlight">\(p_n(x_i) = y_i\)</span> for all <span class="math notranslate nohighlight">\(i = 0, \ldots, n\)</span>.</p>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. Let <span class="math notranslate nohighlight">\(q_n(x)\)</span> be another polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span> that satisfies <span class="math notranslate nohighlight">\(q_n(x_j)=y_j\)</span>. Let <span class="math notranslate nohighlight">\(w_n:=p_n-q_n\)</span>. We then have <span class="math notranslate nohighlight">\(w(x_j)=0\)</span>, <span class="math notranslate nohighlight">\(j=0,\dots,n\)</span>. Hence, <span class="math notranslate nohighlight">\(w_n\)</span> is a polynomial of maximum degree <span class="math notranslate nohighlight">\(n\)</span> with <span class="math notranslate nohighlight">\(n+1\)</span> distinct zeros. However, since a nontrivial polynomial of degree <span class="math notranslate nohighlight">\(n\)</span> can have at most <span class="math notranslate nohighlight">\(n\)</span> zeros, it follows that <span class="math notranslate nohighlight">\(w\equiv 0\)</span>, showing that <span class="math notranslate nohighlight">\(p_n\)</span> is the unique interpolation polynomial.</p>
</div>
<p>We denote the <em>error polynomial</em> by</p>
<div class="math notranslate nohighlight">
\[
\omega_{n+1}(x) := \prod_{j = 0}^n (x - x_j).
\]</div>
<div class="proof theorem admonition" id="theorem-1">
<p class="admonition-title"><span class="caption-number">Theorem 10 </span> (Interpolation error bound)</p>
<section class="theorem-content" id="proof-content">
<p>Suppose <span class="math notranslate nohighlight">\(f \in C^{n+1}[a,b]\)</span> and <span class="math notranslate nohighlight">\(a \le x_0 &lt; \ldots &lt; x_n \le b\)</span>. Let <span class="math notranslate nohighlight">\(p \in \mathcal{P}_n\)</span> such that <span class="math notranslate nohighlight">\(p(x_i) = f(x_i)\)</span> for <span class="math notranslate nohighlight">\(i \in \{ 0, \dots, n\}\)</span>. Then for every <span class="math notranslate nohighlight">\(x \in [a,b]\)</span> there is a <span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span>, depending on <span class="math notranslate nohighlight">\(x\)</span>, such that</p>
<div class="math notranslate nohighlight">
\[
f(x) - p(x) = \frac{\omega_{n+1}(x) f^{(n+1)}(\xi)}{(n+1)!}.
\]</div>
</section>
</div><p>The proof is given in the optional materials section. One disadvantage of the above interpolation error bound is that the result only applies to <span class="math notranslate nohighlight">\(f \in C^{n+1}[a,b]\)</span>. The celebrated Weierstrass approximation theorem shows that control on higher-order derivatives is not necessary for the approximation by polynomials.</p>
<div class="prf-theorem admonition">
<p class="admonition-title">Fact: Weierstrass approximation theorem</p>
<p>Given <span class="math notranslate nohighlight">\(f \in C[a,b]\)</span> and <span class="math notranslate nohighlight">\(\epsilon &gt; 0\)</span>, there exists an <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> and <span class="math notranslate nohighlight">\(p \in \mathcal{P}_n\)</span> such that <span class="math notranslate nohighlight">\(\| f - p \|_\infty &lt; \epsilon\)</span>.</p>
</div>
<p>Here <span class="math notranslate nohighlight">\(\| g \|_\infty = \max_{x \in [a,b]} |g(x)|\)</span> denotes the <span class="math notranslate nohighlight">\(\infty\)</span>-norm on <span class="math notranslate nohighlight">\(C[a,b]\)</span>.</p>
<p>The <span class="math notranslate nohighlight">\(p\)</span> of the Weierstrass approximation theorem has to be selected with much care, and an unrefined interpolation method will generally not provide polynomials which approximate arbitrarily well. This is mainly due to the Runge phenomenon.</p>
<div class="proof example admonition" id="example-2">
<p class="admonition-title"><span class="caption-number">Example 13 </span> (Interpolation with uniformly distributed nodes)</p>
<section class="example-content" id="proof-content">
<p>Unless very smooth functions such as <span class="math notranslate nohighlight">\(\cos\)</span> are interpolated (recall that <span class="math notranslate nohighlight">\(\| \cos^{(n)} \|_\infty = 1\)</span> for all <span class="math notranslate nohighlight">\(n\)</span>th derivatives <span class="math notranslate nohighlight">\(\cos^{(n)}\)</span>, <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span>), one observes that interpolating polynomials of high-order exhibit strong oscillations near the interval ends. This behaviour is known as the Runge phenomenon.</p>
<p>Click through the tabs to see:</p>
<ul class="simple">
<li><p>An example with infinitely many uniformly bounded derivatives.</p></li>
<li><p>An example with infinitely many derivatives.</p></li>
<li><p>An example with a continuous function.</p></li>
<li><p>An example with a discontinuous function.</p></li>
</ul>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
cos(x)</label><div class="sd-tab-content docutils">
<p><img alt="cos" src="_images/cos.png" /></p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Matplotlib code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">lagrange</span>

<span class="c1"># Function to perform polynomial interpolation and plot</span>
<span class="k">def</span> <span class="nf">plot_interpolation</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>  <span class="c1"># evaluate f at the nodes</span>

    <span class="c1"># Perform polynomial interpolation</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
    
    <span class="c1"># evaluate interpolating polynomial at xx</span>
    <span class="n">p_xx</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">p_xx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Fine grid for plotting</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  

<span class="c1"># True function</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">f_xx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>

<span class="c1"># Plot the true function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f_xx</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True Function $f$&#39;</span><span class="p">)</span>

<span class="c1"># Plot for different n</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">]:</span>
    <span class="n">plot_interpolation</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xx</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Formatting the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Polynomial interpolation of the cos function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details></div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
1 / (1 + 15 x^2)</label><div class="sd-tab-content docutils">
<p><img alt="fraction" src="_images/fraction.png" /></p>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
abs(x)</label><div class="sd-tab-content docutils">
<p><img alt="cos" src="_images/abs.png" /></p>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-3">
sign(x)</label><div class="sd-tab-content docutils">
<p><img alt="cos" src="_images/sign.png" /></p>
</div>
</div>
</section>
</div><p>To understand the Runge phenomenon, it is instructive to examine the error term</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{(n+1!)} \, \omega_{n+1}(x) \, f^{(n+1)}(\xi) = E(x), \qquad x \in (x_0, x_n)
\]</div>
<p>more carefully for <span class="math notranslate nohighlight">\(C^\infty\)</span> functions such as the <span class="math notranslate nohighlight">\(x \mapsto \frac{1}{1 + 15 x^2}\)</span> of the previous example. It consists of three parts:</p>
<ul class="simple">
<li><p>the scaling factor <span class="math notranslate nohighlight">\((n+1!)^{-1}\)</span>;</p></li>
<li><p>the error polynomial <span class="math notranslate nohighlight">\(\omega_{n+1}(x)\)</span>, which measures how well the nodes are chosen;</p></li>
<li><p>the derivative <span class="math notranslate nohighlight">\(f^{(n+1)}(\xi)\)</span>, which measures how difficult it is to approximate <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
</ul>
<p>The following plot illustrates how the error polynomial attains its largest values near the domain boundaries.</p>
<p><img alt="error_polynomial" src="_images/error_polynomial.png" /></p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Matplotlib code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">omega</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">):</span>
    <span class="n">omega_xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">xj</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">omega_xx</span> <span class="o">=</span> <span class="n">omega_xx</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">omega_xx</span>

<span class="c1"># Fine grid for plotting</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plot for different n</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]:</span>
  <span class="n">nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">omega_xx</span> <span class="o">=</span> <span class="n">omega</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">omega_xx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Formatting the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Error polynomial of uniformly distributed points&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details><p>Note that the error polynomial’s <span class="math notranslate nohighlight">\(\infty\)</span>-norm decreases as <span class="math notranslate nohighlight">\(n \to \infty\)</span>; however, it is not fast enough to counter the often observed increase in the magnitude of <span class="math notranslate nohighlight">\(f^{(n+1)}(\xi)\)</span> as <span class="math notranslate nohighlight">\(n \to \infty\)</span>.</p>
<p>Can nodes be distributed non-uniformly to better reduce the magnitude of <span class="math notranslate nohighlight">\(\omega\)</span> throughout the interpolation domain? In other words, is there a distribution of nodes <span class="math notranslate nohighlight">\(\{\tilde{x}_0, \ldots, \tilde{x}_m \}\)</span> which has the smallest error polynomial <span class="math notranslate nohighlight">\(\tilde{\omega}_{n+1}\)</span>?</p>
<p>There is indeed such a choice of nodes: these are the roots of Chebyshev polynomials. For <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> they are defined as</p>
<div class="math notranslate nohighlight">
\[
\tilde{x}_i = \cos \Bigl( \frac{2 i + 1}{2 n} \pi \Bigr), \qquad i \in \{ 0, \ldots, n\}.
\]</div>
<p>(Note: Some texts define <span class="math notranslate nohighlight">\(i\)</span> to start from <span class="math notranslate nohighlight">\(1\)</span> in the definition of Chebyshev nodes and adjust <span class="math notranslate nohighlight">\(n\)</span> accordingly. This is only a notational difference.)</p>
<div class="proof theorem admonition" id="theorem-3">
<p class="admonition-title"><span class="caption-number">Theorem 11 </span></p>
<section class="theorem-content" id="proof-content">
<p>Consider <span class="math notranslate nohighlight">\(n+1\)</span> arbitrary, pairwise distinct nodes <span class="math notranslate nohighlight">\(x_0, x_1, \ldots, x_n\)</span> in <span class="math notranslate nohighlight">\([-1,1]\)</span> with error polynomial <span class="math notranslate nohighlight">\(\omega_{n+1}\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[
\| \tilde{\omega}_{n+1} \|_\infty \le \| \omega_{n+1} \|_\infty,
\]</div>
<p><span class="math notranslate nohighlight">\(\tilde{\omega}_{n+1}\)</span> is the error polynomial of the Chebyshev nodes.</p>
</section>
</div><p>The proof is given in the optional materials section. Important for us is that Chebyshev nodes address the issue of Runge’s phenomenon successfully, as illustrated in the following example.</p>
<p>The trick here is that Chebyshev nodes have a finer spacing near the interval boundary, preventing the error polynomial’s strong oscillations.</p>
<p><img alt="error_polynomial" src="_images/cheb_error_polynomial.png" /></p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Matplotlib code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">omega</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">):</span>
    <span class="n">omega_xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">xj</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span> <span class="n">omega_xx</span> <span class="o">=</span> <span class="n">omega_xx</span> <span class="o">*</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">omega_xx</span>

<span class="c1"># Fine grid for plotting</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plot for different n</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span>
    <span class="c1"># Define the Chebyshev nodes</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">omega_xx</span> <span class="o">=</span> <span class="n">omega</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">omega_xx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Formatting the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Error polynomial for Chebechev nodes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details><div class="proof example admonition" id="example-4">
<p class="admonition-title"><span class="caption-number">Example 14 </span> (Interpolation with Chebyshev nodes)</p>
<section class="example-content" id="proof-content">
<p>Here, the same functions as above are interpolated again, this time using Chebyshev nodes. The difference is striking, with a fairly good approximation even in the discontinuous example of the sign function.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-4">
cos(x)</label><div class="sd-tab-content docutils">
<p><img alt="cos" src="_images/cheb_cos.png" /></p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Matplotlib code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">lagrange</span>

<span class="c1"># Function to perform polynomial interpolation and plot</span>
<span class="k">def</span> <span class="nf">plot_interpolation</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>  <span class="c1"># evaluate f at the nodes</span>

    <span class="c1"># Perform polynomial interpolation</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
    
    <span class="c1"># evaluate interpolating polynomial at xx</span>
    <span class="n">p_xx</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">p_xx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Fine grid for plotting</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  

<span class="c1"># True function</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">f_xx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>

<span class="c1"># Plot the true function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f_xx</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True Function $f$&#39;</span><span class="p">)</span>

<span class="c1"># Plot for different n</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">]:</span>
    <span class="c1"># Define the Chebyshev nodes</span>
    <span class="n">chebyshev_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">plot_interpolation</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">chebyshev_nodes</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Formatting the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chebyshev interpolation of the cos function&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details></div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-5">
1 / (1 + 15 x^2)</label><div class="sd-tab-content docutils">
<p><img alt="fraction" src="_images/cheb_fraction.png" /></p>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-6">
abs(x)</label><div class="sd-tab-content docutils">
<p><img alt="abs" src="_images/cheb_modulus.png" /></p>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-7">
sign(x)</label><div class="sd-tab-content docutils">
<p><img alt="sign" src="_images/cheb_sign.png" /></p>
</div>
</div>
</section>
</div><section id="python-skills">
<h2>Python skills<a class="headerlink" href="#python-skills" title="Link to this heading">#</a></h2>
<p>The following code implements Lagrange interpolation and compares Chebyshev and uniform interpolation of the sign function in a single plot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">chebyshev_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate Chebyshev nodes.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">uniform_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate uniform nodes.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">lagrange_interpolation</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform Lagrange interpolation using given nodes.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">lagrange_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">term</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">term</span> <span class="o">*=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">term</span>

    <span class="n">y_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)):</span>
        <span class="n">y_eval</span> <span class="o">+=</span> <span class="n">f</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">*</span> <span class="n">lagrange_basis</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_eval</span>


<span class="c1"># Non-smooth function to interpolate</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Number of nodes</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Evaluation points</span>
<span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

<span class="c1"># Perform Lagrange interpolation with Chebyshev and Uniform nodes</span>
<span class="n">y_interp_chebyshev</span> <span class="o">=</span> <span class="n">lagrange_interpolation</span><span class="p">(</span><span class="n">chebyshev_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">)</span>
<span class="n">y_interp_uniform</span> <span class="o">=</span> <span class="n">lagrange_interpolation</span><span class="p">(</span><span class="n">uniform_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_eval</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Function (|x|)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">y_interp_chebyshev</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chebyshev Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">y_interp_uniform</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Uniform Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">chebyshev_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">chebyshev_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chebyshev Nodes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">uniform_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">uniform_nodes</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Uniform Nodes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of Chebyshev and Uniform Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Notice how the spacing of Chebyshev nodes is tighter near the interval ends:</p>
<p><img alt="cheb_uniform" src="_images/compare_cheb_uniform.png" /></p>
<p>Lagrange interpolation and related methods are built into Scipy, see this <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.lagrange.html">link</a>.</p>
</section>
<section id="self-check-questions">
<h2>Self-check questions<a class="headerlink" href="#self-check-questions" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Given the nodes <span class="math notranslate nohighlight">\(\{x_0, \ldots, x_n\}\)</span>, show that the linearity of the mapping</p>
<div class="math notranslate nohighlight">
\[
\mathbb{R}^{n+1} \to \mathcal{P}_n, (y_0, y_1, \ldots, y_n)^\top \mapsto p,
\]</div>
<p>where <span class="math notranslate nohighlight">\(p \in \mathcal{P}_n\)</span> is the polynomial interpolating the values <span class="math notranslate nohighlight">\(y_i\)</span>.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Given the values <span class="math notranslate nohighlight">\(y_0, y_1, \ldots, y_n \in \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(z_0, z_1, \ldots, z_n \in \mathbb{R}\)</span>, let <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> be the respective interpolating polynomials. Then, for <span class="math notranslate nohighlight">\(\alpha, \beta \in \mathbb{R}\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\alpha p + \beta q \in \mathcal{P}_n
\]</div>
<p class="sd-card-text">and, for <span class="math notranslate nohighlight">\(i \in \{0, \ldots, n\}\)</span>,</p>
<div class="math notranslate nohighlight">
\[
(\alpha p + \beta q)(x_i) = \alpha p(x_i) + \beta q(x_i) = \alpha y_i + \beta z_i.
\]</div>
<p class="sd-card-text">Hence, <span class="math notranslate nohighlight">\(\alpha p + \beta q\)</span> is the interpolating polynomial for the values <span class="math notranslate nohighlight">\(\alpha y_i + \beta z_i\)</span> at <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(i \in \{0, \ldots, n\}\)</span>, which proves the linearity of the mapping.</p>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Consider the following set of data points:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((x_0, y_0) = (1, 1)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((x_1, y_1) = (2, 3)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((x_2, y_2) = (3, 2)\)</span></p></li>
</ul>
<p>Calculate the Lagrange interpolating polynomial that passes through these points.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We find</p>
<div class="math notranslate nohighlight">
\[ 
L_0(x) = \frac{(x - x_1)(x - x_2)}{(x_0 - x_1)(x_0 - x_2)} = \frac{(x - 2)(x - 3)}{(1 - 2)(1 - 3)} = \frac{(x - 2)(x - 3)}{2}
\]</div>
<p class="sd-card-text">and</p>
<div class="math notranslate nohighlight">
\[
L_1(x) = \frac{(x - x_0)(x - x_2)}{(x_1 - x_0)(x_1 - x_2)} = \frac{(x - 1)(x - 3)}{(2 - 1)(2 - 3)} = -(x - 1)(x - 3)
\]</div>
<p class="sd-card-text">and</p>
<div class="math notranslate nohighlight">
\[
L_2(x) = \frac{(x - x_0)(x - x_1)}{(x_2 - x_0)(x_2 - x_1)} = \frac{(x - 1)(x - 2)}{(3 - 1)(3 - 2)} = \frac{1}{2}(x - 1)(x - 2).
\]</div>
<p class="sd-card-text">Using the given <span class="math notranslate nohighlight">\(y\)</span> values, we have <span class="math notranslate nohighlight">\(P(x) = 1 \cdot L_0(x) + 3 \cdot L_1(x) + 2 \cdot L_2(x)\)</span> so that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
P(x) &amp; = 1 \cdot \frac{(x - 2)(x - 3)}{2} - 3(x - 1)(x - 3) + 2 \cdot \frac{1}{2}(x - 1)(x - 2)\\
&amp; = -\frac{3}{2}x^2 + \frac{13}{2}x - 4.
\end{align}
\end{split}\]</div>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Suppose that the interpolation nodes are arranged symmetrically around the origin: for each node <span class="math notranslate nohighlight">\(x_j\)</span>, the node <span class="math notranslate nohighlight">\(-x_j\)</span> also exists in the set of nodes.</p>
<p>Prove that the Lagrange interpolant <span class="math notranslate nohighlight">\(p\)</span> of an odd function is odd.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We must show that <span class="math notranslate nohighlight">\(p(-x) = -p(x)\)</span>. Denote <span class="math notranslate nohighlight">\(x_{i'} = - x_i\)</span> for <span class="math notranslate nohighlight">\(i \in \{0, \ldots, n\}\)</span>. We find</p>
<div class="math notranslate nohighlight">
\[\begin{split}
L_j(-x) = \prod_{\substack{i=0 \\ i \neq j}}^{n} \frac{-x - x_i}{x_j - x_i} = \prod_{\substack{i'=0 \\ i' \neq j'}}^{n} \frac{- x - (-x_{i'})}{(-x_{j'}) - (-x_{i'})} = \prod_{\substack{i'=0 \\ i' \neq j'}}^{n} \frac{x - x_{i'}}{x_{j'} - x_{i'}} = L_{j'}(x)
\end{split}\]</div>
<p class="sd-card-text">Substituting these into <span class="math notranslate nohighlight">\(p(-x)\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[
p(-x) = \sum_{j=0}^{n} f(x_j) L_j(-x) = \sum_{j=0}^{n} f(- x_{j'}) L_{j'}(x) = - \sum_{j=0}^{n} f(x_{j'}) L_{j'}(x) = - p(x).
\]</div>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Some applications require that the interpolating polynomial matches prescibed derivative values in addition to function values. In this spirit, show that for pairwise distinct real numbers <span class="math notranslate nohighlight">\(x_0, x_1, \ldots, x_r\)</span> and nonnegative integers <span class="math notranslate nohighlight">\(m_0, m_1, \ldots, m_r \in \mathbb{N}\)</span> satisfying</p>
<div class="math notranslate nohighlight">
\[
\sum_{j=0}^r m_j = n + 1,
\]</div>
<p>together with given real numbers <span class="math notranslate nohighlight">\(f_j^{(\nu)}\)</span> for <span class="math notranslate nohighlight">\(\nu = 0, 1, \ldots, m_j - 1\)</span> and <span class="math notranslate nohighlight">\(j = 0, 1, \ldots, r\)</span>, there is exactly one polynomial <span class="math notranslate nohighlight">\(P \in \mathcal{P}_n\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
P^{(\nu)}(x_j) \;=\; f_j^{(\nu)} \quad\text{for}\quad \nu = 0, 1, \ldots, m_j - 1, \quad j = 0, 1, \ldots, r.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(P^{(\nu)}\)</span> denotes the <span class="math notranslate nohighlight">\(\nu\)</span>th derivative of <span class="math notranslate nohighlight">\(P\)</span>.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>Uniqueness:</strong> Let <span class="math notranslate nohighlight">\(P, Q \in \mathcal{P}_n\)</span> be two polynomials that satisfy the interpolation conditions. Consider their difference <span class="math notranslate nohighlight">\(R := P - Q\)</span>. We have</p>
<div class="math notranslate nohighlight">
\[
R \;\in\; \mathcal{P}_n, \quad R^{(\nu)}(x_j) \;=\; 0 \;\;\text{for}\;\; \nu = 0, 1, \ldots, m_j - 1,\; j = 0, 1, \ldots, r.
\]</div>
<p class="sd-card-text">In other words, <span class="math notranslate nohighlight">\(R(x)\)</span> and its first <span class="math notranslate nohighlight">\((m_j - 1)\)</span> derivatives vanish at each <span class="math notranslate nohighlight">\(x_j\)</span>.</p>
<p class="sd-card-text">A root of multiplicity <span class="math notranslate nohighlight">\(m\)</span> at a point <span class="math notranslate nohighlight">\(x = x_0\)</span> means the polynomial and its first <span class="math notranslate nohighlight">\((m - 1)\)</span> derivatives vanish at <span class="math notranslate nohighlight">\(x_0\)</span>. Consequently, <span class="math notranslate nohighlight">\(R\)</span> has a root of multiplicity <span class="math notranslate nohighlight">\(m_j\)</span> at <span class="math notranslate nohighlight">\(x_j\)</span>. Summed over <span class="math notranslate nohighlight">\(j = 0,1,\dots,r\)</span>, the number of roots of <span class="math notranslate nohighlight">\(R\)</span>, counted with multiplicity, is</p>
<div class="math notranslate nohighlight">
\[
\sum_{j=0}^r m_j \;=\; n+1.
\]</div>
<p class="sd-card-text">A non-zero polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span> can have at most <span class="math notranslate nohighlight">\(n\)</span> distinct roots, counting multiplicities. But here, <span class="math notranslate nohighlight">\(R\)</span> has <span class="math notranslate nohighlight">\(n+1\)</span> roots in total, implying that <span class="math notranslate nohighlight">\(R \equiv 0\)</span>. Therefore, <span class="math notranslate nohighlight">\(P \equiv Q\)</span>, which proves <em>uniqueness</em>.</p>
<p class="sd-card-text"><strong>Existence:</strong> To prove existence, we use the ansatz</p>
<div class="math notranslate nohighlight">
\[
P(x) \;=\; \sum_{k=0}^n \alpha_k\,x^k
\]</div>
<p class="sd-card-text">for some coefficients <span class="math notranslate nohighlight">\(\alpha_0, \alpha_1, \ldots, \alpha_n\)</span>. The interpolation conditions</p>
<div class="math notranslate nohighlight">
\[
P^{(\nu)}(x_j) \;=\; f_j^{(\nu)}
\]</div>
<p class="sd-card-text">translate into</p>
<div class="math notranslate nohighlight">
\[
\sum_{k=0}^n a_{\nu,j,k}\,\alpha_k \;=\; f_j^{(\nu)} \quad\text{for}\quad \nu = 0, 1, \ldots, m_j - 1, \quad j = 0, 1, \ldots, r,
\]</div>
<p class="sd-card-text">where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
a_{\nu,j,k} \;=\;
\begin{cases}
k\,(k-1)\,\dots\,(k-\nu+1)\, x_j^{\,k-\nu} &amp; \text{if } \nu \le k,\\
0 &amp; \text{otherwise}.
\end{cases}
\end{split}\]</div>
<p class="sd-card-text">This forms a system of <span class="math notranslate nohighlight">\(\sum_{j=0}^r m_j \;=\; n + 1\)</span> linear equations for the <span class="math notranslate nohighlight">\(n + 1\)</span> unknowns <span class="math notranslate nohighlight">\(\alpha_0, \alpha_1, \ldots, \alpha_n\)</span>. By the uniqueness result above, if all <span class="math notranslate nohighlight">\(f_j^{(\nu)} = 0\)</span>, the only solution is the trivial one:</p>
<div class="math notranslate nohighlight">
\[
\alpha_0 = \alpha_1 = \cdots = \alpha_n = 0.
\]</div>
<p class="sd-card-text">Hence, the corresponding system matrix has only the trivial null space and is therefore invertible. It follows that the general system also admits a (non-trivial) solution. This proves existence.</p>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Let <span class="math notranslate nohighlight">\(\varphi_0, \varphi_1, \dots, \varphi_n: C[a,b] \to \mathbb{R}\)</span> be linear functionals, and let
<span class="math notranslate nohighlight">\(\mathcal{V} \subset C[a,b]\)</span> be a linear subspace of dimension <span class="math notranslate nohighlight">\(n+1\)</span>.</p>
<ol class="arabic">
<li><p>Show that the <em>generalised interpolation problem</em></p>
<blockquote>
<div><p>Find <span class="math notranslate nohighlight">\(v \in \mathcal{V}\)</span> such that <span class="math notranslate nohighlight">\(\varphi_j(v) = \varphi_j(f)\)</span> for <span class="math notranslate nohighlight">\(j = 0,1,\dots,n\)</span></p>
</div></blockquote>
<p>is uniquely solvable for each <span class="math notranslate nohighlight">\(f \in C[a,b]\)</span> <em>if and only if</em> the function <span class="math notranslate nohighlight">\(f=0\)</span> has only <span class="math notranslate nohighlight">\(v=0\)</span> as its generalised interpolant.</p>
</li>
<li><p>Assume the generalised interpolation problem is uniquely solvable for every <span class="math notranslate nohighlight">\(f \in C[a,b]\)</span>. Let <span class="math notranslate nohighlight">\(\mathcal{L}_n : C[a,b] \to \mathcal{V}\)</span> be the corresponding <em>interpolation operator</em>, i.e. <span class="math notranslate nohighlight">\(\mathcal{L}_n f = v\)</span>. Show that <span class="math notranslate nohighlight">\(\mathcal{L}_n\)</span> is a linear map and that, for <span class="math notranslate nohighlight">\(f \in C[a,b]\)</span>, the identity <span class="math notranslate nohighlight">\(\mathcal{L}_n f = f\)</span> holds <em>if and only if</em> <span class="math notranslate nohighlight">\(f\)</span> lies in <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>.</p></li>
</ol>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We consider the linear map</p>
<div class="math notranslate nohighlight">
\[
A: \mathcal{V} \;\to\; \mathbb{R}^{\,n+1}, \quad v \;\mapsto\; \bigl(\varphi_j(v)\bigr)_{j=0,\dots,n}.
\]</div>
<p class="sd-card-text">Because <span class="math notranslate nohighlight">\(\dim \mathcal{V} = n+1\)</span>, this linear map <span class="math notranslate nohighlight">\(A\)</span> is injective if and only if it is bijective.</p>
<p class="sd-card-text"><strong>Part 1.</strong> First <span class="math notranslate nohighlight">\(\Longrightarrow\)</span>. Clearly, for the function <span class="math notranslate nohighlight">\(f=0\)</span>, the generalised interpolation problem is solved by <span class="math notranslate nohighlight">\(v = 0\)</span>. By the assumption of uniqueness, <span class="math notranslate nohighlight">\(v=0\)</span> is the only solution.</p>
<p class="sd-card-text">Now <span class="math notranslate nohighlight">\(\Longleftarrow\)</span>. Under the hypothesis, <span class="math notranslate nohighlight">\(A\)</span> is injective and thus bijective. Therefore, for every continuous function <span class="math notranslate nohighlight">\(f : [a,b] \to \mathbb{R}\)</span>, there exists <em>exactly one</em> function <span class="math notranslate nohighlight">\(v \in \mathcal{V}\)</span> satisfying the interpolation conditions <span class="math notranslate nohighlight">\(\varphi_j(v) = \varphi_j(f)\)</span> for <span class="math notranslate nohighlight">\(j = 0,1,\dots,n\)</span>. That proves the statement.</p>
<p class="sd-card-text"><strong>Part 2.</strong> Consider the map</p>
<div class="math notranslate nohighlight">
\[
Q: C[a,b] \;\to\; \mathbb{R}^{\,n+1},
\quad
f \;\mapsto\; \bigl(\varphi_j(f)\bigr)_{j=0,\dots,n}.
\]</div>
<p class="sd-card-text">This map <span class="math notranslate nohighlight">\(Q\)</span> is linear, and therefore the operator <span class="math notranslate nohighlight">\(\mathcal{L}_n = A^{-1} Q\)</span> is also linear.</p>
<p class="sd-card-text">Furthermore, for any <span class="math notranslate nohighlight">\(f \in \mathcal{V}\)</span>, the solution to the generalised interpolation problem is exactly <span class="math notranslate nohighlight">\(v = f\)</span>. Consequently, <span class="math notranslate nohighlight">\(\mathcal{L}_n f = f\)</span>. Finally, for every continuous function <span class="math notranslate nohighlight">\(f : [a,b] \to \mathbb{R}\)</span>, we have <span class="math notranslate nohighlight">\(\mathcal{L}_n f \in \mathcal{V}\)</span>. Thus, if <span class="math notranslate nohighlight">\(\mathcal{L}_n f = f\)</span>, it follows that <span class="math notranslate nohighlight">\(f\)</span> itself must lie in <span class="math notranslate nohighlight">\(\mathcal{V}\)</span>. This completes the proof.</p>
</div>
</details></section>
<section id="optional-material">
<h2>Optional material<a class="headerlink" href="#optional-material" title="Link to this heading">#</a></h2>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Proof of the interpolation error bound</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Recall Rolle’s theorem from the appendix.</p>
<div class="proof admonition" id="proof">
<p class="sd-card-text">Proof. For any <span class="math notranslate nohighlight">\(x = x_i\)</span>, where <span class="math notranslate nohighlight">\(x_i\)</span> is one of the interpolation points, the error formula holds trivially since <span class="math notranslate nohighlight">\(f(x_i) = p(x_i)\)</span> and <span class="math notranslate nohighlight">\(\omega_{n+1}(x_i) = 0\)</span>.</p>
<p class="sd-card-text">For <span class="math notranslate nohighlight">\(x \notin \{x_0, \ldots, x_n\}\)</span>, consider the auxiliary function defined on <span class="math notranslate nohighlight">\([a, b]\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\psi(x') := f(x') - p(x') - C \omega_{n+1}(x'),
\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(C\)</span> is a constant chosen such that <span class="math notranslate nohighlight">\(\psi(x) = 0\)</span>.</p>
<p class="sd-card-text">The function <span class="math notranslate nohighlight">\(\psi\)</span> has at least <span class="math notranslate nohighlight">\(n+2\)</span> distinct zeros: <span class="math notranslate nohighlight">\(x_0, \ldots, x_n\)</span>, and <span class="math notranslate nohighlight">\(x\)</span>. By applying Rolle’s Theorem successively, we find that <span class="math notranslate nohighlight">\(\psi'\)</span> has at least <span class="math notranslate nohighlight">\(n+1\)</span> distinct zeros, <span class="math notranslate nohighlight">\(\psi''\)</span> has at least <span class="math notranslate nohighlight">\(n\)</span> zeros, and so on, up to <span class="math notranslate nohighlight">\(\psi^{(n+1)}\)</span>, which must have at least one zero <span class="math notranslate nohighlight">\(\xi\)</span> in the interval <span class="math notranslate nohighlight">\([a, b]\)</span>.</p>
<p class="sd-card-text">Since <span class="math notranslate nohighlight">\(p\)</span> is a polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span>, its <span class="math notranslate nohighlight">\((n+1)\)</span>th derivative is identically zero, i.e., <span class="math notranslate nohighlight">\(p^{(n+1)} \equiv 0\)</span>. For <span class="math notranslate nohighlight">\(\omega_{n+1}\)</span>, a polynomial of degree <span class="math notranslate nohighlight">\(n+1\)</span> with leading coefficient <span class="math notranslate nohighlight">\(1\)</span>, its <span class="math notranslate nohighlight">\((n+1)\)</span>th derivative is constant: <span class="math notranslate nohighlight">\(\omega_{n+1}^{(n+1)} = (n+1)!\)</span>.</p>
<p class="sd-card-text">Thus, at the root <span class="math notranslate nohighlight">\(\xi\)</span>, we have <span class="math notranslate nohighlight">\(0 = \psi^{(n+1)}(\xi) = f^{(n+1)}(\xi) - C (n+1)!\)</span>, leading to:</p>
<div class="math notranslate nohighlight">
\[
C = \frac{f^{(n+1)}(\xi)}{(n+1)!}.
\]</div>
<p class="sd-card-text">Substituting this value back into the definition of <span class="math notranslate nohighlight">\(\psi\)</span> completes the proof.</p>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Chebyshev interpolation</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="proof definition admonition" id="definition-5">
<p class="admonition-title"><span class="caption-number">Definition 9 </span></p>
<section class="definition-content" id="proof-content">
<p class="sd-card-text"><em>Chebyshev polynomials of first kind</em> are defined by the recursive formula</p>
<div class="math notranslate nohighlight">
\[
T_0(x) = 1, \quad T_1(x) = x, \quad T_{n+1}(x) = 2 x T_n(x) - T_{n-1}(x).
\]</div>
</section>
</div><p class="sd-card-text">Chebyshev polynomials are considered on the reference interval <span class="math notranslate nohighlight">\([-1,1]\)</span> with only a few exceptions. We shall use the terms Chebyshev polynomial of the first kind and Chebyshev polynomial synonymously.</p>
<div class="proof theorem admonition" id="theorem-6">
<p class="admonition-title"><span class="caption-number">Theorem 12 </span></p>
<section class="theorem-content" id="proof-content">
<p class="sd-card-text">For <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> and <span class="math notranslate nohighlight">\(x \in [-1,1]\)</span> the identity <span class="math notranslate nohighlight">\(T_n(x) = \cos(n \arccos x)\)</span> holds.</p>
</section>
</div><div class="proof admonition" id="proof">
<p class="sd-card-text">Proof. The result is obvious for <span class="math notranslate nohighlight">\(n=0\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span>. Suppose <span class="math notranslate nohighlight">\(T_n(x) = \cos(n \arccos x)\)</span> is true. Let <span class="math notranslate nohighlight">\(x = \cos \theta\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
T_{n+1}(x) &amp;= 2 x T_n(x) - T_{n-1}(x) = 2 \cos \theta \cos(n \theta) - \cos((n-1) \theta)\\
&amp;= 2 \cos \theta \cos(n \theta) - \cos \theta \cos(n \theta) - \sin \theta \sin  (n\theta)\\
&amp;= \cos \theta \cos(n \theta) - \sin \theta \sin  (n\theta) = \cos((n+1) \theta) = \cos((n+1) \arccos x).
\end{align*}
\end{split}\]</div>
<p class="sd-card-text">Here we used <span class="math notranslate nohighlight">\(\cos (\alpha \pm \beta) = \cos \alpha \cos \beta \mp \sin \alpha \sin \beta\)</span>.</p>
</div>
<p class="sd-card-text">It follows that the roots of <span class="math notranslate nohighlight">\(T_n\)</span> are</p>
<div class="math notranslate nohighlight">
\[
\tilde{x}_i = \cos \Bigl( \frac{2 i + 1}{2 n} \pi \Bigr), \qquad i \in \{ 0, \ldots, n-1\},
\]</div>
<p class="sd-card-text">and that the extrema of <span class="math notranslate nohighlight">\(T_n\)</span> are attained at</p>
<div class="math notranslate nohighlight">
\[
\tilde{y}_i = \cos \Bigl( \frac{i \pi}{n} \Bigr), \qquad i \in \{ 0, \ldots, n\},
\]</div>
<p class="sd-card-text">with <span class="math notranslate nohighlight">\(T_n(\tilde{y}_i) = (-1)^i\)</span>. The roots <span class="math notranslate nohighlight">\(\tilde{x}_i\)</span> are called Chebyshev nodes. The below theorem states that the <span class="math notranslate nohighlight">\(\tilde{x}_i\)</span> are the best nodes to minimise the oscillations of the error polynomial.</p>
<div class="proof theorem admonition" id="theorem-7">
<p class="admonition-title"><span class="caption-number">Theorem 13 </span></p>
<section class="theorem-content" id="proof-content">
<p class="sd-card-text">Suppose <span class="math notranslate nohighlight">\(p \in \mathcal{P}_n\)</span> interpolates <span class="math notranslate nohighlight">\(f \in C^{(n+1)}[a,b]\)</span> at the Chebyshev nodes <span class="math notranslate nohighlight">\(\tilde{x}_0, \ldots, \tilde{x}_n\)</span>. Let <span class="math notranslate nohighlight">\(\tilde{\omega}_{n+1}\)</span> be the error polynomial corresponding to these nodes. Then</p>
<div class="math notranslate nohighlight">
\[
\tilde{\omega}_{n+1}(x) = 2^{-n} T_{n+1}(x)
\]</div>
<p class="sd-card-text">and</p>
<div class="math notranslate nohighlight">
\[
\| f - p \|_\infty \le \frac{\| f^{(n+1)} \|_\infty}{2^n (n+1)!}.
\]</div>
<p class="sd-card-text">Consider <span class="math notranslate nohighlight">\(n+1\)</span> arbitrary, pairwise distinct nodes <span class="math notranslate nohighlight">\(x_0, x_1, \ldots, x_n\)</span> in <span class="math notranslate nohighlight">\([-1,1]\)</span> with error polynomial <span class="math notranslate nohighlight">\(\omega_{n+1}\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[
\| \tilde{\omega}_{n+1} \|_\infty \le \| \omega_{n+1} \|_\infty.
\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p class="sd-card-text">Proof. Notice <span class="math notranslate nohighlight">\(\| 2^{-n} T_{n+1} \|_\infty = 2^{-n}\)</span> since <span class="math notranslate nohighlight">\(T_{n+1}(x) = \cos((n+1) \arccos x)\)</span>. Because <span class="math notranslate nohighlight">\(T_{n+1}\)</span> and <span class="math notranslate nohighlight">\(\tilde{\omega}_{n+1}\)</span> both belong to <span class="math notranslate nohighlight">\(\mathcal{P}_{n+1}\)</span> and vanish at <span class="math notranslate nohighlight">\(\tilde{x}_0, \ldots \tilde{x}_n\)</span> there is a <span class="math notranslate nohighlight">\(c \in \mathbb{R}\)</span> such that <span class="math notranslate nohighlight">\(T_{n+1} = c \, \tilde{\omega}_{n+1}\)</span>. Recalling the definition of Chebyshev nodes, one has <span class="math notranslate nohighlight">\(c = 1\)</span> if <span class="math notranslate nohighlight">\(n = 1\)</span>. Because of <span class="math notranslate nohighlight">\(T_{n+1}(x) = 2 x T_n(x) - T_{n-1}(x)\)</span> the highest-order coefficient of <span class="math notranslate nohighlight">\(T_{n+1}\)</span> is twice that of <span class="math notranslate nohighlight">\(T_n\)</span>. As the highest-order coefficient of <span class="math notranslate nohighlight">\(\tilde{\omega}_{n+1}\)</span> is <span class="math notranslate nohighlight">\(1\)</span>, induction gives <span class="math notranslate nohighlight">\(c = 2^n\)</span>. The Interpolation error bound implies</p>
<div class="math notranslate nohighlight">
\[
| f(x) - p(x) | \le \frac{\| \omega_{n+1} \|_\infty \, \| f^{(n+1)} \|_\infty}{(n+1)!} = \frac{\| f^{(n+1)} \|_\infty}{2^n (n+1)!}.
\]</div>
<p class="sd-card-text">Suppose there are nodes <span class="math notranslate nohighlight">\(x_0, x_1, \ldots, x_n\)</span> such that <span class="math notranslate nohighlight">\(\| \tilde{\omega}_{n+1} \|_\infty &gt; \| \omega_{n+1} \|_\infty\)</span>. Then <span class="math notranslate nohighlight">\(q := \tilde{\omega}_{n+1} - \omega_{n+1}\)</span> belongs to <span class="math notranslate nohighlight">\(\mathcal{P}_n\)</span> and at the extrema of <span class="math notranslate nohighlight">\(T_{n+1}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
q(\tilde{y}_i) = \begin{cases}
&gt; 0 &amp; \mbox{ if $i$ even},\\
&lt; 0 &amp;  \mbox{ if $i$ odd}.
\end{cases}
\end{split}\]</div>
<p class="sd-card-text">By the intermediate value theorem, <span class="math notranslate nohighlight">\(q\)</span> has <span class="math notranslate nohighlight">\(n+1\)</span> roots. Thus <span class="math notranslate nohighlight">\(q = 0\)</span>.</p>
</div>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Barycentric interpolation</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">In practical applications, Barycentric Interpolation, a variant of Lagrange interpolation, is often utilized due to its computational efficiency.</p>
<p class="sd-card-text">Let us define the function <span class="math notranslate nohighlight">\(\ell(x) = \prod_{j=0}^n (x - x_j)\)</span>, and introduce weights <span class="math notranslate nohighlight">\(w_k = \left[\prod_{j=0, j\neq k}^n (x_k - x_j)\right]^{-1}\)</span>. With these definitions, the Lagrange basis polynomials can be expressed as:</p>
<div class="math notranslate nohighlight">
\[
L_k(x) = \ell(x) \frac{w_k}{x - x_k},
\]</div>
<p class="sd-card-text">leading to the polynomial interpolation formula:</p>
<div class="math notranslate nohighlight">
\[
p_n(x) = \ell(x) \sum_{k=0}^n \frac{w_k}{x - x_k} y_k.
\]</div>
<p class="sd-card-text">This expression is known as the first Barycentric form. It allows the efficient computation of <span class="math notranslate nohighlight">\(p_n(x)\)</span> in <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> operations, assuming the weights <span class="math notranslate nohighlight">\(w_k\)</span> are precomputed.</p>
<p class="sd-card-text">An even more streamlined approach is possible by interpolating the constant function <span class="math notranslate nohighlight">\(1\)</span>, which results in:</p>
<div class="math notranslate nohighlight">
\[
1 = \ell(x) \sum_{k=0}^n \frac{w_k}{x - x_k}.
\]</div>
<p class="sd-card-text">This leads to an alternative formulation of the polynomial:</p>
<div class="math notranslate nohighlight">
\[
p_n(x) = \frac{\sum_{k=0}^n \frac{w_k}{x - x_k} y_k}{\sum_{k=0}^n \frac{w_k}{x - x_k}}.
\]</div>
<p class="sd-card-text">This expression is referred to as the second Barycentric form. It notably avoids the direct computation of <span class="math notranslate nohighlight">\(\ell(x)\)</span>, further simplifying the interpolation process.</p>
</div>
</details></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.4_constrained_least_squares_problems.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Least-squares with constraints</p>
      </div>
    </a>
    <a class="right-next"
       href="4.2_quadrature.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to quadrature</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-skills">Python skills</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-check-questions">Self-check questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-material">Optional material</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Timo Betcke, Erik Burman, Max Jensen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>