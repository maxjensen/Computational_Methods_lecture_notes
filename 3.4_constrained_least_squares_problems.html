
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Least-squares with constraints &#8212; Computational Methods MATH0058 lecture notes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3.4_constrained_least_squares_problems';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Polynomial interpolation" href="4.1_interpolation.html" />
    <link rel="prev" title="Least-squares problems" href="3.3_least_squares_problems.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Computational Methods MATH0058 lecture notes - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Computational Methods MATH0058 lecture notes - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Fundamentals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0.1_matrix_vector_norms.html">Measuring distances</a></li>
<li class="toctree-l1"><a class="reference internal" href="0.2_error_analysis.html">Backward error analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="0.3_linear_system_error.html">The condition number of linear systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="0.4_complexity_notation.html">Asymptotic notation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Implementation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.1_floating_point_arithmetic.html">Floating point numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.2_numpy_and_data_layouts.html">Memory layout and NumPy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LU Decomposition</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="2.1_lu_decomposition.html">LU decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.2_lu_backward_error.html">Backward error and pivoting</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.3_python_lu_decomposition.html">Python implementation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Orthogonal Decompositions</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="3.1_qr_decomposition.html">QR decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.2_singular_value_decomposition.html">Singular value decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.3_least_squares_problems.html">Least-squares problems</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Least-squares with constraints</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interpolation and Quadrature</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="4.1_interpolation.html">Polynomial interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.2_quadrature.html">Introduction to quadrature</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.3_stable_quadrature_schemes.html">Stable quadrature schemes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Eigenvalue Problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="5.1_eigenvalues_basic_properties.html">Basic properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.2_computing_eigenvalues.html">Computing eigenvalues</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.3_computing_eigenspaces.html">Computing the eigensystem</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bm1_notation_and_facts.html">Notation and facts</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm2_programming_resources.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm3_markdown.html">Markdown and LaTeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm4_bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="bm5_typos.html">Report typos</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3.4_constrained_least_squares_problems.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Least-squares with constraints</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#certificates-of-optimality">Certificates of optimality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duality">Duality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-skills">Python skills</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-problems">Least-squares problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-check-questions">Self-check questions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="least-squares-with-constraints">
<h1>Least-squares with constraints<a class="headerlink" href="#least-squares-with-constraints" title="Link to this heading">#</a></h1>
<p>In many applications, optimisation problems are posed with constraints. We consider here constrained least-squares problems of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\min_x &amp; \| A x - a \|_2 \\
\text{subject to} &amp;\\
&amp; C x = c,\\
&amp; D x \ge d.
\end{array}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(c \in \mathbb{R}^p\)</span>, <span class="math notranslate nohighlight">\(d \in \mathbb{R}^q\)</span>, <span class="math notranslate nohighlight">\(C \in \mathbb{R}^{p \times n}\)</span>, <span class="math notranslate nohighlight">\(D \in \mathbb{R}^{q \times n}\)</span> and <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span>. The expression <span class="math notranslate nohighlight">\(D x \ge d\)</span> is to be understood componentwise: for <span class="math notranslate nohighlight">\(d, e \in \mathbb{R}^p\)</span>,</p>
<div class="math notranslate nohighlight">
\[
d \ge e \qquad \Leftrightarrow \qquad d_i \ge e_i \quad \forall \; i \in \{1, \ldots, q\}.
\]</div>
<p>Because of the constraints, the techniques from the previous section do not apply directly, as the problem is inherently nonlinear.</p>
<p>Setting <span class="math notranslate nohighlight">\(B = A^\top A\)</span> and <span class="math notranslate nohighlight">\(b = - A^\top a\)</span>, we rewrite the above least-squares problem in the generic form of a quadratic programme.</p>
<div class="admonition-primal-problem-quadratic-programme admonition">
<p class="admonition-title">Primal problem (quadratic programme)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\min_x &amp; \frac{1}{2} x^\top B x + b^\top x\\
\text{subject to} &amp;\\
&amp; C x - c = 0,\\
&amp; D x - d \ge 0.
\end{array}
\end{split}\]</div>
</div>
<p>Both problems have the same minimisers because</p>
<div class="math notranslate nohighlight">
\[
\textstyle \frac{1}{2} \| A x - a \|_2^2 = \frac{1}{2} x^\top A^\top A  x - a^\top A x + \frac{1}{2} a^\top a = x^\top B x + b^\top x + \frac{1}{2} a^\top a,
\]</div>
<p>noting that the constant term <span class="math notranslate nohighlight">\(\frac{1}{2} a^\top a\)</span> can be removed without changing the set of minimisers. Because of our initial assumption <span class="math notranslate nohighlight">\(B = A^\top A\)</span> we shall assume throughout the section that <span class="math notranslate nohighlight">\(B\)</span> is symmetric and positive semi-definite. We refer to <span class="math notranslate nohighlight">\(\frac{1}{2} x^\top B x + b^\top x\)</span> as the <em>objective function</em>, <span class="math notranslate nohighlight">\(C x - c = 0\)</span> the <em>equality constraint</em> and <span class="math notranslate nohighlight">\(D x - d \ge 0\)</span> the <em>inequality constraint</em>. The <em>value</em> of the optimal control problem is that value of the objective function when evaluated at an optimal solution.</p>
<p>Observe, that the value of the initial problem in least-squares form differs from that of quadratic programme because of the factor <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> and the squaring of the norm and the constant term, even if the set of optimal solutions coincide. However, given a optimal solution <span class="math notranslate nohighlight">\(x\)</span> it is simple to compute the value <span class="math notranslate nohighlight">\(\| A x - a \|_2\)</span>.</p>
<section id="certificates-of-optimality">
<h2>Certificates of optimality<a class="headerlink" href="#certificates-of-optimality" title="Link to this heading">#</a></h2>
<p>In this section, we learn about <em>certificates of optimality</em>, which address a fundamental point: The algorithms to solve constrained least-squares problem are outside of the scope of this module. How, then, can you solve such problems with confidence? More generally, how can you use numerical methods, that you have not mathematically fully understood?</p>
<p>This is a question you face now, as you only begin with computational mathematics and want to use a wide range of methods as quickly as possible. But even as a seasoned numerical analyst, you will need to think about deploying mathematical algorithms in application scenarios where users are not domain experts.</p>
<p>A key realisation is that verifying whether a candidate solution is indeed equal to (or at least a good approximation of) an exaxt solution is often much simpler than finding such a candidate in the first place.</p>
<p>You are familiar with this situation from other areas of mathematics: For</p>
<div class="math notranslate nohighlight">
\[
F(t) = \int_0^\top f(x) dx,
\]</div>
<p>it can be hard to find <span class="math notranslate nohighlight">\(F\)</span> given <span class="math notranslate nohighlight">\(f\)</span>, but once a candidate <span class="math notranslate nohighlight">\(F\)</span> is found, it is relatively easy to check that its derivative is <span class="math notranslate nohighlight">\(f\)</span>. Similarly, various encryption methods rely on the fact that it is easier to multiply two prime numbers than to find the prime factors of a given product.</p>
<p>A certificate of optimality consists of a candidate solution together with additional information that makes it relatively easy to confirm the quality of the candidate solution; even if the method by which the candidate solution was obtained is not examined. In other areas of numerical analysis and scientific computing one finds similar concepts; for example, <em>a posteriori error bounds</em> are used to appraise the quality of numerical solutions of differential equations.</p>
</section>
<section id="duality">
<h2>Duality<a class="headerlink" href="#duality" title="Link to this heading">#</a></h2>
<p>There are different types of certificates of optimality; many of them are based on the important concept of <em>duality</em>, which plays a key role throughout scientific computing; differential equations again serve as a good example.</p>
<p>The <em>Lagrangian function</em> associated with the primal problem is</p>
<div class="math notranslate nohighlight">
\[
L(x, y, s) := \frac{1}{2} x^\top B x + b^\top x - y^\top (C x - c) - s^\top (D x - d).
\]</div>
<p>The variables <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(s\)</span> are called <em>Lagrangian multipliers</em>. All information about the primal problem is encoded within the Lagrangian function through the observation that for any given vector <span class="math notranslate nohighlight">\(x\)</span> (self-check question)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\max_{y, s \atop s \geq 0} L(x, y, s) =
\begin{cases}
\frac{1}{2} x^\top B x + b^\top x &amp; \text{if $C x = c$ and $D x \geq d$,}\\
+\infty &amp; \text{otherwise.}
\end{cases}
\end{split}\]</div>
<p>Therefore, the primal problem can be recast in a more abstract form.</p>
<div class="admonition-primal-problem-abstract-form admonition">
<p class="admonition-title">Primal problem (abstract form)</p>
<div class="math notranslate nohighlight">
\[
\min_x \max_{y, s \atop s \geq 0} L(x, y, s)
\]</div>
</div>
<p>The <em>dual problem</em> is obtained by reversing the order of the min and max operations.</p>
<div class="admonition-dual-problem-abstract-form admonition">
<p class="admonition-title">Dual problem (abstract form)</p>
<div class="math notranslate nohighlight">
\[
\max_{y, s \atop s \geq 0} \min_x L(x, y, s)
\]</div>
</div>
<p>Within mathematics, we speak of duality when we identify two structures <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> and a transformation <span class="math notranslate nohighlight">\(\Phi\)</span>, where <span class="math notranslate nohighlight">\(\Phi(A) = B\)</span> and <span class="math notranslate nohighlight">\(\Phi(B) = A\)</span>. Here <span class="math notranslate nohighlight">\(\Phi\)</span> corresponds to the reversal of <span class="math notranslate nohighlight">\(\max\)</span> and <span class="math notranslate nohighlight">\(\min\)</span>. Now convince yourself (self-check question) that the dual problem can be written as follows:</p>
<div class="admonition-dual-problem-quadratic-programme admonition">
<p class="admonition-title">Dual problem (quadratic programme)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\max_{x,y,s} &amp; c^\top y + d^\top s - \frac{1}{2} x^\top B x\\
\text{subject to} &amp;\\
&amp; C^\top y + D^\top s - B x = b,\\
&amp; s \ge 0.
\end{array}
\end{split}\]</div>
</div>
<p>We call <span class="math notranslate nohighlight">\(x\)</span> a <em>feasible point</em> of the primal problem if <span class="math notranslate nohighlight">\(C x = c\)</span> and <span class="math notranslate nohighlight">\(D x \ge d\)</span>. Similarly, <span class="math notranslate nohighlight">\((x,y,s)\)</span> is feasible for the dual problem if <span class="math notranslate nohighlight">\(C^\top y + D^\top s - B x = b\)</span> and <span class="math notranslate nohighlight">\(s \ge 0\)</span>. In short, feasible points are those that satisfy the constraints.</p>
<p>There is a fundamental connection between the primal and dual problem</p>
<div class="proof theorem admonition" id="theorem-0">
<p class="admonition-title"><span class="caption-number">Theorem 7 </span> (Weak duality)</p>
<section class="theorem-content" id="proof-content">
<p>Assume that <span class="math notranslate nohighlight">\(\bar{x}\)</span> and <span class="math notranslate nohighlight">\((x,y,s)\)</span> are feasible points of the primal and dual problems, respectively. Then</p>
<div class="math notranslate nohighlight">
\[
c^\top y + d^\top s - \frac{1}{2} x^\top B x \leq \frac{1}{2} \bar{x}^\top B \bar{x} + b^\top \bar{x}.
\]</div>
<p>In other words, among feasible points, the objective function of the dual problem attains values below than or equal to those of the primal function.</p>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. For feasible <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\((x,y,s)\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
c^\top y + d^\top s - \frac{1}{2} x^\top B x \, \leq \, &amp; (C \bar{x})^\top y + (D \bar{x})^\top s - \frac{1}{2} x^\top B x\\
= \, &amp; (C^\top y + D^\top s)^\top \bar{x} - \frac{1}{2} x^\top B x\\
= \, &amp; (b + B x)^\top \bar{x} - \frac{1}{2} x^\top B x\\
= \, &amp; \frac{1}{2} \bar{x}^\top B \bar{x} + b^\top \bar{x} - \frac{1}{2} (x - \bar{x})^\top B (x - \bar{x})\\
\leq \, &amp; \frac{1}{2} \bar{x}^\top B \bar{x} + b^\top \bar{x}.
\end{align*}
\end{split}\]</div>
</div>
<p>Bearing the weak duality theorem in mind, we call a pair <span class="math notranslate nohighlight">\((\bar{x}, (x,y,s))\)</span> a certificate of optimality. To check that <span class="math notranslate nohighlight">\(\bar{x}\)</span> is indeed solution to the primal problem we need to do the following:</p>
<ol class="arabic simple">
<li><p>Check that <span class="math notranslate nohighlight">\(\bar{x}\)</span> is a feasible point of the primal problem.</p></li>
<li><p>Check that <span class="math notranslate nohighlight">\((x,y,s)\)</span> is a feasible point of the dual problem.</p></li>
<li><p>Check that <span class="math notranslate nohighlight">\(c^\top y + d^\top s - \frac{1}{2} x^\top B x = \frac{1}{2} \bar{x}^\top B \bar{x} + b^\top \bar{x}\)</span>.</p></li>
</ol>
<p>All those steps only require the evaluation of simple matrix vector and scalar products.</p>
<p>Why does this work? Suppose that <span class="math notranslate nohighlight">\(\bar{x}\)</span> and <span class="math notranslate nohighlight">\((x,y,s)\)</span> passed the above tests 1., 2. and 3., but <span class="math notranslate nohighlight">\(\bar{x}\)</span> was not an optimal solution. Then there exists another feasible point <span class="math notranslate nohighlight">\(\tilde{x}\)</span> of the primal problem with an even lower value:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2} \tilde{x}^\top B \tilde{x} + b^\top \tilde{x} &lt; \frac{1}{2} \bar{x}^\top B \bar{x} + b^\top \bar{x} = c^\top y + d^\top s - \frac{1}{2} x^\top B x.
\]</div>
<p>This is impossible by weak duality, and therefore <span class="math notranslate nohighlight">\(\bar{x}\)</span> must be optimal.</p>
<p>With <span class="math notranslate nohighlight">\(\bar{x}\)</span> and <span class="math notranslate nohighlight">\((x,y,s)\)</span> optimal, the difference</p>
<div class="math notranslate nohighlight">
\[
\underbrace{\frac{1}{2} \bar{x}^\top B \bar{x} + b^\top \bar{x}}_{\text{optimal value of the primal problem}} - \underbrace{c^\top y + d^\top s - \frac{1}{2} x^\top B x}_{\text{optimal value of the dual problem}}
\]</div>
<p>is called the <em>duality gap</em>.</p>
<p>One might wonder if certificates of the type <span class="math notranslate nohighlight">\((\bar{x}, (x,y,s))\)</span> are too restrictive: Could there be optimisation problems for which the duality gap exceeds 0? Then the above certificate of optimality would not work even if optimal solutions are found (self-check question). The following deep result, known as strong duality, shows that this cannot happen for constrained least-squares problems.</p>
<div class="proof theorem admonition" id="theorem-1">
<p class="admonition-title"><span class="caption-number">Theorem 8 </span> (Strong duality)</p>
<section class="theorem-content" id="proof-content">
<p>Assume that either the primal or dual problem has a feasible point. Then this problem is bounded if and only if the other has a feasible point.  In such cases, both problems have optimal solutions and share the same optimal value.</p>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. The proof is beyond the scope of the lecture notes. See <span id="id1">[<a class="reference internal" href="bm4_bibliography.html#id7" title="Jorge Nocedal and Stephen J. Wright. Numerical optimization. Springer Series in Operations Research and Financial Engineering. Springer, New York, second edition, 2006. URL: https://ucl.primo.exlibrisgroup.com/permalink/44UCL_INST/155jbua/alma990010854280204761.">Nocedal and Wright, 2006</a>]</span> for details.</p>
</div>
<p>In contrast, many optimisation problems, for example with non-convex objective function or constraints, exhibit a positive duality gap, making it more difficult to certify optimality.</p>
</section>
<section id="python-skills">
<h2>Python skills<a class="headerlink" href="#python-skills" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://www.cvxpy.org/">CVXPY</a> is a Python library designed to make the construction and solving of quadratic and other convex optimisation problems straightforward. Its high-level syntax allows users to specify an objective and constraints in a manner similar to writing down the mathematical formulation. Under the hood, CVXPY automatically transforms the problem into a canonical form, selects an appropriate solver, and returns primal and dual solutions, all while handling domain restrictions, dual variables, and convergence tolerances. This streamlined workflow makes it an ideal tool for both <a class="reference external" href="https://www.cvxpy.org/examples/index.html">instructional examples</a> and real-world applications.</p>
<section id="least-squares-problems">
<h3>Least-squares problems<a class="headerlink" href="#least-squares-problems" title="Link to this heading">#</a></h3>
<p>The code below illustrates a template for solving least-squares problems of the type discussed above. Here, <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code> and <code class="docutils literal notranslate"><span class="pre">d</span></code> are initialised randomly for demonstration. By substituting specific data, one can easily solve practical least-squares problems.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># ------------------------------------------------</span>
<span class="c1"># Example data (adjust as appropriate).</span>
<span class="c1"># ------------------------------------------------</span>
<span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Construct a least-squares setup:</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">A</span>
<span class="n">b_vec</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">a</span>

<span class="c1"># Constraints:</span>
<span class="c1">#   Cx - c = 0  -&gt;  in CVXPY: C@x == c</span>
<span class="c1">#   Dx - d &gt;= 0 -&gt;  in CVXPY: D@x &gt;= d</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="c1"># Define the variable and constraints in CVXPY</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">C</span> <span class="o">@</span> <span class="n">x</span> <span class="o">==</span> <span class="n">c</span><span class="p">,</span>  <span class="c1"># equality</span>
    <span class="n">D</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">d</span>   <span class="c1"># inequality</span>
<span class="p">]</span>

<span class="c1"># Objective</span>
<span class="n">objective</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">cp</span><span class="o">.</span><span class="n">quad_form</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_vec</span> <span class="o">@</span> <span class="n">x</span>

<span class="c1"># Formulate the problem</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">objective</span><span class="p">),</span> <span class="n">constraints</span><span class="p">)</span>

<span class="c1"># Solve</span>
<span class="n">primal_value</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">SCS</span><span class="p">)</span>  <span class="c1"># or another solver</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Primal objective value:&quot;</span><span class="p">,</span> <span class="n">primal_value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Primal solution x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># Original least-squares problem</span>
<span class="n">ls_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original least-squares objective:&quot;</span><span class="p">,</span> <span class="n">ls_value</span><span class="p">)</span>
</pre></div>
</div>
<p>This code returns the optimiser <code class="docutils literal notranslate"><span class="pre">x</span></code>, the value of the primal quadratic programme, and the value of the original least-squares problem. To check that CVXPY has indeed found an optimal solution, we also retrieve the dual variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain y and s from the solver.</span>
<span class="c1"># CVXPY stores in constraints[0].dual_value the variable -y instead of y</span>
<span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">constraints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dual_value</span>  
<span class="n">s</span> <span class="o">=</span> <span class="n">constraints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dual_value</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dual variable y (equality):&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dual variable s (inequality):&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="c1"># Compute x from the dual problem:</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">b_vec</span>
<span class="n">xDual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">@</span> <span class="n">rhs</span>  <span class="c1"># Use the pseudo-inverse if B is semidefinite.</span>

<span class="c1"># Evaluate the dual objective</span>
<span class="n">dual_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">d</span> <span class="o">@</span> <span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">xDual</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">B</span> <span class="o">@</span> <span class="n">xDual</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dual objective value:&quot;</span><span class="p">,</span> <span class="n">dual_value</span><span class="p">)</span>

<span class="c1"># Duality gap</span>
<span class="n">gap</span> <span class="o">=</span> <span class="n">primal_value</span> <span class="o">-</span> <span class="n">dual_value</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duality gap:&quot;</span><span class="p">,</span> <span class="n">gap</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that CVXPY does not directly return the <span class="math notranslate nohighlight">\(x\)</span> of the dual problem; it merely provides <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(s\)</span>. We recover the dual <span class="math notranslate nohighlight">\(x\)</span> from the dual equality constraint. The pseudo-inverse (<code class="docutils literal notranslate"><span class="pre">pinv</span></code>) is needed if B is only positive semidefinite. As always, a near-zero duality gap indicates strong duality and certifies that the solution is optimal.</p>
</section>
</section>
<section id="self-check-questions">
<h2>Self-check questions<a class="headerlink" href="#self-check-questions" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Consider the least-squares problem in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\min_x &amp; \| A x - a \|_2 \\
\text{subject to} &amp;\\
&amp; x_1 + x_2 = 1,\\
&amp; x \ge 0
\end{array}
\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \begin{pmatrix}
2 &amp; 1\\ 1 &amp; 2
\end{pmatrix}, \qquad
a = \begin{pmatrix}
1\\ 2
\end{pmatrix}.
\end{split}\]</div>
<p>Write down the primal and dual quadratic programme. What is the Lagrangian function?</p>
<p>You are provided with the certificates of optimality</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\bar{x}^{(1)} &amp; = (0.5, 0.5)^\top,\\
(x^{(1)},y^{(1)},s^{(1)}) &amp; = ((0.5, 0.5)^\top, 1, (0,0)^\top).
\end{align*}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\bar{x}^{(2)} &amp; = (0, 1)^\top,\\
(x^{(2)},y^{(2)},s^{(2)}) &amp; = ((0.5, 0.5)^\top, 0, (0,0)^\top).
\end{align*}
\end{split}\]</div>
<p>Determine for each certificate whether it is a valid proof that <span class="math notranslate nohighlight">\(\bar{x}_i\)</span> is optimal solution of the primal problem, <span class="math notranslate nohighlight">\(i = 1\)</span> resp. <span class="math notranslate nohighlight">\(i = 2\)</span>.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>Step 1. Primal quadratic programme:</strong> First, we rewrite the objective <span class="math notranslate nohighlight">\(\|A x - a\|_2\)</span> in a quadratic form:</p>
<div class="math notranslate nohighlight">
\[
\|A x - a\|_2^2 
\;=\;
(A x - a)^\top (A x - a)
\;=\;
x^\top (A^\top A)\,x \;-\; 2\,a^\top A\,x \;+\; a^\top a,
\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(A^\top = A\)</span> since <span class="math notranslate nohighlight">\(A\)</span> is symmetric. Defining</p>
<div class="math notranslate nohighlight">
\[
B := A^\top A 
\quad\text{and}\quad
b := -\,A^\top a,
\]</div>
<p class="sd-card-text">the quadratic objective takes the usual form <span class="math notranslate nohighlight">\(\tfrac12\,x^\top B x + b^\top x + \text{const}\)</span>. Concretely:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
B = A^2 = \begin{pmatrix}5 &amp; 4\\ 4 &amp; 5\end{pmatrix}, \qquad 
b = -\,A a = \begin{pmatrix}-4 \\ -5\end{pmatrix}.
\end{split}\]</div>
<p class="sd-card-text">Ignoring the constant <span class="math notranslate nohighlight">\(a^\top a\)</span> (which does not affect the minimiser), we get the primal quadratic programme:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\displaystyle \min_{x \in \mathbb{R}^2} 
&amp; \tfrac12 \,x^\top B\,x \;+\; b^\top x 
\\[6pt]
\text{subject to} 
&amp; x_1 + x_2 = 1,\\
&amp; x_1 \ge 0,\; x_2 \ge 0.
\end{array}
\end{split}\]</div>
<p class="sd-card-text"><strong>Step 2. Lagrangian function:</strong> We define the Lagrangian function with multipliers <span class="math notranslate nohighlight">\(y \in \mathbb{R}\)</span> for the equality and <span class="math notranslate nohighlight">\(s \in \mathbb{R}^2_{\ge 0}\)</span> for <span class="math notranslate nohighlight">\(x \ge 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[
L(x,y,s) 
\;=\;
\tfrac12\,x^\top B\,x 
\;+\;
b^\top x
\;-\;
y\,\bigl(x_1 + x_2 \,-\,1\bigr)
\;-\;
s^\top x.
\]</div>
<p class="sd-card-text">The term <span class="math notranslate nohighlight">\(-\,y\,(x_1+x_2 -1)\)</span> encodes <span class="math notranslate nohighlight">\(x_1 + x_2 = 1\)</span>, while <span class="math notranslate nohighlight">\(-\,s^\top x\)</span> encodes <span class="math notranslate nohighlight">\(x \ge 0\)</span> with <span class="math notranslate nohighlight">\(s \ge 0\)</span>.</p>
<p class="sd-card-text">**Step 3. The least-squares problem has the following quadratic programme:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\max_{(x,y,s), \; s \ge 0}
&amp;&amp;&amp; y \;-\;\tfrac12\,x^\top B\,x
\\
\text{subject to}
&amp;&amp;&amp; B\,x \;=\; y\,(1,1)^\top \;+\; s \;-\; (4,5)^\top,\quad s \ge 0.
\end{aligned}
\end{split}\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(c^\top y = 1 \cdot y\)</span> (because the equality constraint is <span class="math notranslate nohighlight">\(x_1+x_2=1\)</span>) and <span class="math notranslate nohighlight">\(d^\top s = 0\)</span> (because <span class="math notranslate nohighlight">\(d = 0\)</span> in the inequality constraints).</p>
<p class="sd-card-text"><strong>Step 4. Checking the first certificate of optimality:</strong> We are given a <em>candidate</em> solution <span class="math notranslate nohighlight">\(\bar{x}^{(1)} = (0.5, 0.5)^\top\)</span> and a <em>dual triple</em> <span class="math notranslate nohighlight">\((\,x^{(1)},\,y^{(1)},\,s^{(1)}) = \bigl((0.5,0.5)^\top,\,1,\,(0,0)\bigr)\)</span>. We must check <em>three</em> conditions for a valid certificate of optimality:</p>
<ol class="arabic simple">
<li><p class="sd-card-text"><em>Primal feasibility</em> of <span class="math notranslate nohighlight">\(\bar{x}\)</span>: This holds because <span class="math notranslate nohighlight">\(x_1^{(1)} + x_2^{(1)} = 0.5 + 0.5 = 1\)</span> and <span class="math notranslate nohighlight">\(x_1^{(1)},\,x_2^{(1)} \ge 0\)</span>.</p></li>
<li><p class="sd-card-text"><em>Dual feasibility</em> of <span class="math notranslate nohighlight">\((x,y,s)\)</span>: This does <em>not</em> hold. While we have <span class="math notranslate nohighlight">\(s^{(1)} = (0,0) \ge 0\)</span>, the equality constraint is not satisfied:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
B\,x^{(1)} = \begin{pmatrix}4.5\\4.5\end{pmatrix} \neq y \begin{pmatrix}1\\1\end{pmatrix} + s - b = \begin{pmatrix}1\\1\end{pmatrix} + \begin{pmatrix}0\\0\end{pmatrix} - \begin{pmatrix}-4\\-5\end{pmatrix} = \begin{pmatrix}5\\6\end{pmatrix}.
\end{split}\]</div>
<ol class="arabic simple" start="3">
<li><p class="sd-card-text"><em>Equality of primal and dual objective values</em> (only relevant once both are feasible).</p></li>
</ol>
<p class="sd-card-text">Because the second step <em>fails</em>, this certificate does <em>not</em> ensure that <span class="math notranslate nohighlight">\(\bar{x}^{(1)}\)</span> is optimal. (However note that that the failure of certification does not prove that <span class="math notranslate nohighlight">\(\bar{x}^{(1)}\)</span> is not optimal.)</p>
<p class="sd-card-text"><strong>Step 5. Checking the second certificate of optimality:</strong> We are given a <em>candidate</em> solution <span class="math notranslate nohighlight">\(\bar{x}^{(2)} = (0, 1)^\top\)</span> and a <em>dual triple</em> <span class="math notranslate nohighlight">\((\,x^{(2)},\,y^{(2)},\,s^{(2)}) = \bigl((0.5,0.5)^\top,\,0,\,(0,0)\bigr)\)</span>.</p>
<ol class="arabic simple">
<li><p class="sd-card-text"><em>Primal feasibility</em> of <span class="math notranslate nohighlight">\(\bar{x}\)</span>: This holds because <span class="math notranslate nohighlight">\(x_1 + x_2 = 0 + 1 = 1\)</span> and <span class="math notranslate nohighlight">\(x_1,\,x_2 \ge 0\)</span>.</p></li>
<li><p class="sd-card-text"><em>Dual feasibility</em> of <span class="math notranslate nohighlight">\((x,y,s)\)</span> This holds because <span class="math notranslate nohighlight">\(s = (0,0)\)</span> satisfies <span class="math notranslate nohighlight">\(s \ge 0\)</span> and</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
B\,x = \begin{pmatrix}4\\5\end{pmatrix} = y \begin{pmatrix}1\\1\end{pmatrix} + s - b = \begin{pmatrix}0\\0\end{pmatrix} + \begin{pmatrix}0\\0\end{pmatrix} - \begin{pmatrix}-4\\-5\end{pmatrix}.
\end{split}\]</div>
<ol class="arabic simple" start="3">
<li><p class="sd-card-text"><em>Equality of primal and dual objective values</em>: This holds because <span class="math notranslate nohighlight">\(\tfrac12 \,\bar{x}^\top B\,\bar{x} \;+\; b^\top \bar{x} = -2.5 = y \;-\;\tfrac12\,x^\top B\,x\)</span></p></li>
</ol>
<p class="sd-card-text">Therefore, the certificate passed all checks and <span class="math notranslate nohighlight">\(\bar{x}^{(2)}\)</span> is an optimal solution to the primal problem.</p>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>The <em>Lagrangian function</em> associated with the primal problem is</p>
<div class="math notranslate nohighlight">
\[
L(x, y, s) := \frac{1}{2} x^\top B x + b^\top x - y^\top (C x - c) - s^\top (D x - d).
\]</div>
<p>Show that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\max_{y, s \atop s \geq 0} L(x, y, s) =
\begin{cases}
\frac{1}{2} x^\top B x + b^\top x &amp; \text{if $C x = c$ and $D x \geq d$,}\\
+\infty &amp; \text{otherwise.}
\end{cases}
\end{split}\]</div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">If any component <span class="math notranslate nohighlight">\((Cx - c)_i \neq 0\)</span>, we can send the corresponding <span class="math notranslate nohighlight">\(y_i\)</span> to <span class="math notranslate nohighlight">\(+\infty\)</span> or <span class="math notranslate nohighlight">\(-\infty\)</span> (depending on the sign of <span class="math notranslate nohighlight">\((Cx - c)_i\)</span>), causing the term <span class="math notranslate nohighlight">\(-\,y_i\,(Cx - c)_i\)</span> to grow without bound.  Therefore, to keep the Lagrangian finite, we need <span class="math notranslate nohighlight">\((Cx - c)_i = 0\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>, i.e. <span class="math notranslate nohighlight">\(Cx = c\)</span>.</p>
<p class="sd-card-text">Similarly, if <span class="math notranslate nohighlight">\((Dx - d)_j &lt; 0\)</span> for some <span class="math notranslate nohighlight">\(j\)</span>, choosing <span class="math notranslate nohighlight">\(s_j \to +\infty\)</span> makes <span class="math notranslate nohighlight">\(-\,s_j\,(Dx - d)_j\)</span> go to <span class="math notranslate nohighlight">\(+\infty\)</span>. Hence, to avoid an unbounded Lagrangian, we require <span class="math notranslate nohighlight">\(Dx \ge d\)</span>. Thus, the maximum is finite only if <span class="math notranslate nohighlight">\(Cx = c\)</span> and <span class="math notranslate nohighlight">\(Dx \ge d\)</span>. In that scenario, we can simply pick <span class="math notranslate nohighlight">\(y = 0\)</span> and <span class="math notranslate nohighlight">\(s = 0\)</span>, yielding</p>
<div class="math notranslate nohighlight">
\[
\max_{y,s \ge 0} L(x,y,s)
=
\tfrac{1}{2}\,x^\top B\,x + b^\top x.
\]</div>
<p class="sd-card-text">Hence,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\max_{y, s \atop s \geq 0} L(x, y, s)
=
\begin{cases}
\tfrac{1}{2} x^\top B x + b^\top x &amp; \text{if } C x = c \text{ and } D x \ge d,\\
+\infty &amp; \text{otherwise.}
\end{cases}
\end{split}\]</div>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Show that the dual problem</p>
<div class="math notranslate nohighlight">
\[
\max_{y, s \atop s \geq 0} \min_x L(x, y, s) = \max_{y, s \atop s \geq 0} \min_x \Big[ \frac{1}{2} x^\top B x + b^\top x - y^\top (C x - c) - s^\top (D x - d) \Big]
\]</div>
<p>can be written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\max_{x,y,s} &amp; c^\top y + d^\top s - \frac{1}{2} x^\top B x\\
\text{subject to} &amp;\\
&amp; C^\top y + D^\top s - B x = b,\\
&amp; s \ge 0.
\end{array}
\end{split}\]</div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We first examine the inner minimisation <span class="math notranslate nohighlight">\(\min_x L(x,y,s)\)</span> for fixed <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(s\)</span>. Differentiating <span class="math notranslate nohighlight">\(L\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span> and setting the gradient to zero gives</p>
<div class="math notranslate nohighlight">
\[
0 = \nabla_{\!x} \, L (x,y,s) = Bx + b - C^\top y - D^\top s.
\]</div>
<p class="sd-card-text">If there are two solutions <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(\tilde{x}\)</span> of <span class="math notranslate nohighlight">\(B x = C^\top y + D^\top s - b\)</span> then</p>
<div class="math notranslate nohighlight">
\[
x^\top B\,x - \tilde{x}^\top B\,\tilde{x} = (x - \tilde{x})^\top (C^\top y + D^\top s - b) = (x - \tilde{x})^\top B\,x = 0
\]</div>
<p class="sd-card-text">because <span class="math notranslate nohighlight">\(x - \tilde{x} \in \ker B^\top = \ker B\)</span>. Therefore for any solution <span class="math notranslate nohighlight">\(\tilde{x}\)</span> of <span class="math notranslate nohighlight">\(B x = C^\top y + D^\top s - b\)</span>, the inner minimisation problem satisfies</p>
<div class="math notranslate nohighlight">
\[
\min_x L(x,y,s) \;=\; c^\top y \;+\; d^\top s \;-\; \tfrac12 \,\tilde{x}^\top B\,\tilde{x},
\]</div>
<p class="sd-card-text">using the simplification of <span class="math notranslate nohighlight">\(L\)</span> arising from <span class="math notranslate nohighlight">\(B \tilde{x} = C^\top y + D^\top s - b\)</span>. If <span class="math notranslate nohighlight">\(B\,x = C^\top y + D^\top s - b\)</span> has no solution then <span class="math notranslate nohighlight">\(x \mapsto L(x,y,s)\)</span> has no stationary point and <span class="math notranslate nohighlight">\(\min_x L(x,y,s) = - \infty\)</span>.</p>
<p class="sd-card-text">We turn to the outer maximisation over all <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(s\ge0\)</span>. If there are  <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(s\)</span> such that <span class="math notranslate nohighlight">\(Bx = C^\top y + D^\top s - b\)</span> then the maximum is attained among those. Otherwise the maximum is <span class="math notranslate nohighlight">\(- \infty\)</span>. Note that also <span class="math notranslate nohighlight">\(\max \emptyset = -\infty\)</span>. The dual problem therefore becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
\displaystyle \max_{x,y,s} 
&amp; 
c^\top y + d^\top s \;-\; \tfrac12\,x^\top B\,x
\\[4pt]
\text{subject to} 
&amp;
C^\top y + D^\top s - B\,x = b,
\quad
s \ge 0.
\end{array}
\end{split}\]</div>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>To examine optimisation problems without strong duality, we consider a possibly non-quadratic optimisation problem. Given <span class="math notranslate nohighlight">\(f : \mathbb{R}^n \to \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(h : \mathbb{R}^n \to \mathbb{R}^p\)</span> and <span class="math notranslate nohighlight">\(g : \mathbb{R}^n \to \mathbb{R}^q\)</span>, let the Lagrangian function be</p>
<div class="math notranslate nohighlight">
\[
L(x, y, s) :=f(x) - y^\top h(x) - s^\top g(x),
\]</div>
<p>giving rise to the primal problem</p>
<div class="math notranslate nohighlight">
\[
v_p := \min_x \underbrace{\max_{y, s \atop s \geq 0} L(x, y, s)}_{=: P(x)} = \min_x P(x)
\]</div>
<p>and the dual problem</p>
<div class="math notranslate nohighlight">
\[
v_d := \max_{y, s \atop s \geq 0} \underbrace{\min_x L(x, y, s)}_{=: D(y,s)} = \max_{y, s \atop s \geq 0} D(y,s).
\]</div>
<p>Suppose that a minimiser <span class="math notranslate nohighlight">\(\bar{x}\)</span> of the primal problem exists and that a maximiser <span class="math notranslate nohighlight">\((y,s)\)</span> of the dual problem exists. For that <span class="math notranslate nohighlight">\((y,s)\)</span> let <span class="math notranslate nohighlight">\(x\)</span> be a minimiser of <span class="math notranslate nohighlight">\(\min_x L(x, y, s)\)</span>.</p>
<p>We say that strong duality does not hold if <span class="math notranslate nohighlight">\(v_d &lt; v_p\)</span>; note that the inquality is strict. Explain why in this case <span class="math notranslate nohighlight">\((\bar{x}, (x,y,s))\)</span> cannot be used as certificate of optimimality as above.</p>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Strong duality provides an alternative way to identify optimal solutions: Given candidate solutions <span class="math notranslate nohighlight">\(\bar{x}\)</span> and <span class="math notranslate nohighlight">\((x, y, s)\)</span>, we plug them into the primal and dual problem, respectively. If they are feasible and return the same value, they are optimal. More formally, they are guaranteed to be optimal of primal and dual problem, respectively, if</p>
<div class="math notranslate nohighlight">
\[
L(\bar{x}, \bar{y}, \bar{s}) = L(x, y, s)
\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(\bar{y}\)</span>, <span class="math notranslate nohighlight">\(\bar{s}\)</span> are maximisers of the inner primal optimisation problem <span class="math notranslate nohighlight">\(\max_{\bar{y}, \bar{s} \atop \bar{s} \geq 0} L(x, y, s)\)</span>.</p>
<p class="sd-card-text">But if strong duality does not hold, then this equality is not satisfied (<span class="math notranslate nohighlight">\(v_d \neq v_p\)</span>) and the alternative characterisation of optimal solutions fails.</p>
<p class="sd-card-text"><strong>Note:</strong> You may observe a slight asymmetry in the way we state the certificate of optimality: The primal problem <span class="math notranslate nohighlight">\(\min_x P(x) = \min_x \max_{y, s \atop s \geq 0} L(x, y, s)\)</span> has the variable <span class="math notranslate nohighlight">\(x\)</span> of the outer optimisation and <span class="math notranslate nohighlight">\((y,s)\)</span> of the inner optimisation. For the dual problem <span class="math notranslate nohighlight">\(\max_{y, s \atop s \geq 0} D(y,s) = \max_{y, s \atop s \geq 0} \min_x L(x, y, s)\)</span> roles are reversed. The certificate <span class="math notranslate nohighlight">\((\bar{x}, (x,y,s))\)</span> refers to the outer variable of the <em>primal</em> problem while to the <em>inner and outer</em> variables of the dual problem. This happened because in the chapter above our starting point was the quadratic programme, in which <span class="math notranslate nohighlight">\(\bar{y}\)</span>, <span class="math notranslate nohighlight">\(\bar{s}\)</span> do not appear explicitly. For the abstract theory we could always assume that <span class="math notranslate nohighlight">\(\bar{y}\)</span>, <span class="math notranslate nohighlight">\(\bar{s}\)</span> can be recovered from solving the inner primal optimisation problem, restoring symmetry.</p>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>You have three food products, labelled 1, 2, and 3, with the following characteristics:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Product</p></th>
<th class="head"><p>Price per kg (pounds)</p></th>
<th class="head"><p>Protein content (g per kg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>5.0</p></td>
<td><p>150</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>3.5</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>7.0</p></td>
<td><p>220</p></td>
</tr>
</tbody>
</table>
</div>
<p>You want to blend these products (in nonnegative quantities <span class="math notranslate nohighlight">\(x_1, x_2, x_3\)</span> kg) to reach a target protein intake of <span class="math notranslate nohighlight">\(R = 200\)</span> grams, but you also want to cap the cost at 6 pounds. However, it may not be possible to match the target exactly without violating the cost limit, so you decide to solve a least-squares problem: Minimise the deviation from 200 grams of protein per kg, i.e.</p>
<div class="math notranslate nohighlight">
\[
   \min_{x} \;\|A x - a\|_2,
   \]</div>
<p>where <span class="math notranslate nohighlight">\(A = \begin{pmatrix} 150 &amp; 100 &amp; 220 \end{pmatrix}\)</span>, <span class="math notranslate nohighlight">\(a = 200\)</span>, subject to the cost constraint  <span class="math notranslate nohighlight">\(5\,x_1 + 3.5\,x_2 + 7\,x_3 \le 6\)</span> and the nonnegativity constraint <span class="math notranslate nohighlight">\(x_1, x_2, x_3 \ge 0.\)</span>.</p>
<ol class="arabic">
<li><p>Rewrite the least-squares objective in the form</p>
<div class="math notranslate nohighlight">
\[
   \frac12\,x^\top B\,x \;+\; b^\top x 
   \quad (\text{ignore any constant term}).
   \]</div>
<p>Identify the explicit matrices <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
</li>
<li><p>Express all constraints in matrix form, i.e. <span class="math notranslate nohighlight">\(D x \ge d\)</span>, and state the final quadratic programme</p>
<div class="math notranslate nohighlight">
\[
   \min_{x} \quad \frac12\,x^\top B\,x + b^\top x
   \quad
   \text{subject to}
   \quad
   D x \ge d.
   \]</div>
</li>
<li><p>Interpret the role of the cost constraint within this least-squares setup. Under what circumstance might you exactly meet the 200-gram protein target?</p></li>
<li><p>Find the optimal solution with CVXPY.</p></li>
</ol>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<ol class="arabic">
<li><p class="sd-card-text"><strong>Formulating the least-squares problem</strong>:</p>
<p class="sd-card-text">The (squared) least-squares objective is</p>
<div class="math notranslate nohighlight">
\[
   \|A x - a\|_2^2
   =
   \bigl(150\,x_1 + 100\,x_2 + 220\,x_3 - 200\bigr)^2.
   \]</div>
<p class="sd-card-text">We can expand and then write this in the usual form <span class="math notranslate nohighlight">\(x^\top B\,x + b^\top x + \text{const}\)</span>. Specifically:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
     B = A^\top A =
     \begin{pmatrix}
       150\\ 100\\ 220
     \end{pmatrix}
     \begin{pmatrix}
       150 &amp; 100 &amp; 220
     \end{pmatrix}
     =
     \begin{pmatrix}
       150^2 &amp; 150\cdot 100 &amp; 150\cdot 220\\
       100\cdot 150 &amp; 100^2 &amp; 100\cdot 220\\
       220\cdot 150 &amp; 220\cdot 100 &amp; 220^2
     \end{pmatrix}.
   \end{split}\]</div>
<p class="sd-card-text">and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
     b = - A^\top a = - \begin{pmatrix}
       200 \cdot 150\\ 200 \cdot 100\\ 200 \cdot 220
     \end{pmatrix}.
   \end{split}\]</div>
<p class="sd-card-text">Note that any constant term <span class="math notranslate nohighlight">\(200^2\)</span> does not affect the minimiser.</p>
</li>
<li><p class="sd-card-text"><strong>Constraints in matrix form</strong>:</p>
<p class="sd-card-text">We can write the cost constraint as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{pmatrix}
       5 &amp; 3.5 &amp; 7
    \end{pmatrix}
    \begin{pmatrix}
       x_1 \\ x_2 \\ x_3
    \end{pmatrix}
    \;\le\; 10.
    \end{split}\]</div>
<p class="sd-card-text">The non-negativity constraint is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
     \begin{pmatrix}
       1 &amp; 0 &amp; 0 \\
       0 &amp; 1 &amp; 0 \\
       0 &amp; 0 &amp; 1
     \end{pmatrix}
     x 
     \;\ge\;
     \begin{pmatrix}
       0 \\ 0 \\ 0
     \end{pmatrix}.
     \end{split}\]</div>
<p class="sd-card-text">Putting all inequalities together, we can define</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    D 
    =
    \begin{pmatrix}
     -5 &amp; -3.5 &amp; -7 \\[4pt]
     1 &amp; 0 &amp; 0\\
     0 &amp; 1 &amp; 0\\
     0 &amp; 0 &amp; 1
    \end{pmatrix},
    \quad
    d
    =
    \begin{pmatrix}
     -10 \\ 0 \\ 0 \\ 0
    \end{pmatrix}.
    \end{split}\]</div>
<p class="sd-card-text">The final quadratic programme is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
    \min_{x} \quad
    &amp; \tfrac12 \,x^\top B\,x \;+\; b^\top x 
    \\
    \text{subject to}\quad
    &amp; D\,x \;\ge\; d.
    \end{aligned}.
    \end{split}\]</div>
</li>
<li><p class="sd-card-text"><strong>Interpretation</strong>:</p>
<ul class="simple">
<li><p class="sd-card-text">Minimising <span class="math notranslate nohighlight">\(\|A x - a\|_2\)</span> steers <span class="math notranslate nohighlight">\(x\)</span> toward achieving exactly 200 grams of protein.</p></li>
<li><p class="sd-card-text">The constraint <span class="math notranslate nohighlight">\(\sum_i \text{price}_i\,x_i \le 6\)</span> caps the total cost. If 200 grams of protein cannot be reached within 6 pounds, the solution will yield a mix <span class="math notranslate nohighlight">\(x\)</span> that partially meets the target but does not exceed the cost.</p></li>
<li><p class="sd-card-text">If the cost limit is large (say <span class="math notranslate nohighlight">\(\ge 10\)</span>), the solver will likely achieve <span class="math notranslate nohighlight">\(\|A x - a\|_2 = 0\)</span> (i.e. exactly 200 grams) because there is no financial barrier to picking enough high-protein product.</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<ol class="arabic" start="4">
<li><p class="sd-card-text"><strong>CVXPY:</strong> We can solve the problem with CVXPY, using the below code. The optimal solution achieves approximately 189 grams per kile at a cost of 6 pounds. This code implements the least-squares problem in its original form. If a certificate of optimality is needed, adapt the code of the Python skills section to solve this problem.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Problem data</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">220</span><span class="p">]])</span>  <span class="c1"># 1x3</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">200.0</span>
<span class="n">price</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">])</span>
<span class="n">cost_limit</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># Define variable</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Objective: least-squares</span>
<span class="c1"># Minimize ||A x - a||_2^2 = (A x - a)^2 in this 1D case</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">sum_squares</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span>

<span class="c1"># Constraints</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">price</span> <span class="o">@</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">cost_limit</span><span class="p">,</span>  <span class="c1"># cost constraint</span>
    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span>                    <span class="c1"># nonnegativity</span>
<span class="p">]</span>

<span class="c1"># Form and solve</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">SCS</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimal objective (squared deviation):&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solution x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Check cost:&quot;</span><span class="p">,</span> <span class="n">price</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;(&lt;= 10.0)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Protein intake:&quot;</span><span class="p">,</span> <span class="n">A</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;(target 200)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
</details><div class="tip admonition">
<p class="admonition-title"><strong>Question</strong></p>
<p>Let <span class="math notranslate nohighlight">\(\ell(x,y) = 0\)</span> if <span class="math notranslate nohighlight">\(x \neq y\)</span> and otherwise <span class="math notranslate nohighlight">\(\ell(x,y) = 1\)</span> where <span class="math notranslate nohighlight">\(x,y \in \mathbb{R}\)</span>. Show that</p>
<div class="math notranslate nohighlight">
\[
\max_y \min_x \ell(x,y) &lt; \min_x \max_y \ell(x,y).
\]</div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Answer</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">We have</p>
<div class="math notranslate nohighlight">
\[
\max_y \min_x \ell(x,y) = \max_y 0 = 0 &lt; 1 = \min_x 1 = \min_x \max_y \ell(x,y).
\]</div>
</div>
</details></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.3_least_squares_problems.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Least-squares problems</p>
      </div>
    </a>
    <a class="right-next"
       href="4.1_interpolation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Polynomial interpolation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#certificates-of-optimality">Certificates of optimality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#duality">Duality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-skills">Python skills</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-problems">Least-squares problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#self-check-questions">Self-check questions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Timo Betcke, Erik Burman, Max Jensen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>